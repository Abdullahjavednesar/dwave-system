language: python

matrix:
    include:
        - os: linux
          sudo: required
          python: "2.7"
          env: TOXENV=py27
        - os: linux
          sudo: required
          python: "3.6"
          env: TOXENV=py36
        - os: linux
          sudo: required
          python: "nightly"
          env: TOXENV=pynightly
        - os: osx
          language: generic
          env: TOXENV=py27
          before_install:
            - brew update
            - virtualenv env -p python2
            - source env/bin/activate
        - os: osx
          language: generic
          env: TOXENV=py36
          before_install:
            - brew update
            - brew install python3
            - virtualenv env -p python3
            - source env/bin/activate

install:
    - pip install .[tests]
    - pip install coveralls
    
script:
- coverage run -m unittest discover

after_success:
  - coveralls

deploy:
  provider: pypi
  user: "dwtools"
  password:
    secure: "lNTa9WRYbp9Yan0PWbGSFRKnlMrDWwNSEMyPVM/owfMrQLVojoq7Y2Kr6r/hm0iR/LvQb7FfPZQWGCyQr8yXeY0/ID7OO5e4n6iJQTY0e/O6PMqKLDAaPDyXx5SFymBCgtDsIJaUd/lFyH02ZgLsTKEjwJoqp+8pnkAYe7HEFOrgIRacN7RktMfm8gsRVXtGelr8JPnAQ56e9EV9oblvd9Etut4jyLUeWzWn1hPY4XBnBYHm15dblJFC2AqUo/el1CKKBCiv91d7GA2TqJrt5BocM/h+3oZb9h0mak/YrAKmbHUWjFn/ru6ndsOEpVOkURJ+kFmdbWGWgWPQgLLi0oAf9K1TPFhRRWFremU4NSL4PS7bhpUdgcGKQq2rFqAIRSSwpvn32aIi4ke5RtSazVB9PjddV1D7GxAmOQLcyds19Ajl96aUZ3S9NpOXx9PUZyT3unmm2h6EpAfGImdifHhK+SXyo58ycl0fTfDh/aGL0M5WTEvzwy3I8NRl/4ZS0g0jK4plheEoi/bFnCP6XZ/au8AbVDy8CWepHEnXaABpKPoKLC1Yrc1FIQpiAy42VjPSV6Tn9XMKyiFG35OVQmiHPkQAo8Oup9LZUFGBU4X82n3upHlaUS/+oB/LQAf+rtrG58V2oG4mJl1Lkgj7m8/DwUgJyHGjAXZDkuL/oZQ="
    distributions: "sdist bdist_wheel"
  skip_cleanup: true
  on:
    tags: true
