language: python

matrix:
    include:
        - os: linux
          sudo: required
          python: "2.7"
          env: TOXENV=py27
        - os: linux
          sudo: required
          python: "3.6"
          env: TOXENV=py36
        - os: linux
          sudo: required
          python: "nightly"
          env: TOXENV=pynightly
        - os: osx
          language: generic
          env: TOXENV=py27
          before_install:
            - brew update
            - virtualenv env -p python2
            - source env/bin/activate
        - os: osx
          language: generic
          env: TOXENV=py36
          before_install:
            - brew update
            - brew install python3
            - virtualenv env -p python3
            - source env/bin/activate

install:
    - pip install .[tests]
    - pip install coveralls
    
script:
- coverage run -m unittest discover

after_success:
  - coveralls

deploy:
  provider: pypi
  user: "dwtools"
  password:
    secure: "A3fQ1YM5y8V2OwK2y+hRQCobfhXu4++YXRfBah8/ljAIBjvJuEQGuhWUqqsIqznhE0dpnMe2zNVdvHpj86wV7yKf5eEpAseTa0auOMWbb6zwMjjDt/2xHcNOljwpFip1lIrcKJPMFBl+LwehPJKV1tOKUfAwhYEc3ygzzvGHAcRRLmiqQPH7hMU84YbGik6Pl7cgXucQF3XqQYhOuxPbiAj2eUMpCNe/EE1qwBibXzCl8ZHDFDJ3peMb94F7oiS8moRqHjOhGDzREXZiCL9fKpYYsqeUx2V8hv6ddO5UKbV2QeoYTOkHl7LmobHgTOPhZfSPIxB5wm691Ar3yHbxnQVEZCNI2QrjVYyYfbfj7/jCQxHyHt/vxb4wxQpJEyoryiTRPZv/3epsrFX2oW8JyAhFycmDEDn8qCXPZmufmBxe50+UbxaF4mZnklVLMQxcqe0iJWFil+VQdAiHNgx30ixV1RMaNP7Ud9kdgeIBv0eDK/EdoZBM+upV0dpd4dkspj635wq9HC4JIXcrtQ9QiOBb3wdxg4h6yZrkY/87hlYzhb2o2AIM4ef4CP2dPQiJbglGubpAgsaJXe67Ba0IBtDZ5+XEB/ZiqwawGkrnMlxpLNmPHQTmVdcquokOVqbiQ5jniWqhmZYgMzx/CBS9EmG7gnxOOifpYUUxHHYhQRk="
  distributions: "sdist bdist_wheel"
  skip_cleanup: true
  on:
    tags: true
